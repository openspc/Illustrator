// サブフォルダも含めたAIファイル一覧を取得するvar fileExt = "*.ai";  // 拡張子がaiのファイルを取得する(function(){    var folderObj = Folder.selectDialog("フォルダを選択してください");    if (!folderObj) return;	// キャンセルされたら処理しない    var txt = "";    txt = getFolder(folderObj, txt, "");    var txtObj = activeDocument.textFrames.add();    txtObj.top = -10;    txtObj.contents = txt;  // ドキュメント上に表示する})();// フォルダ内の一覧を取得function getFolder(folderObj, txt, indent){    var fileList = folderObj.getFiles(fileExt);    for(var i=0; i<fileList.length; i++){        txt = txt + indent + decodeURI(fileList[i].name) + "\r";    }    var fileList = folderObj.getFiles();     for (var i=0; i<fileList.length; i++){        if (fileList[i].getFiles) {            txt = txt + indent + "■"+decodeURI(fileList[i].name) + "\r";	// フォルダの場合に先頭に■を追加する            txt = getFolder(fileList[i], txt, indent+"＿");	// インデント文字を変更する場合は、ここの＿を変更する        }    }    return txt;}