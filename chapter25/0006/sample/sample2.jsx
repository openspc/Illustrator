// フォルダ内のAIファイルを取得する(function(){    var folderObj = Folder.selectDialog("フォルダを選択してください");    if (!folderObj) return;	// キャンセルされたら処理しない    var fileList = folderObj.getFiles("*.ai");    var txt = "";    for(var i=0; i<fileList.length; i++){        txt = txt + convertKana(fileList[i].name) + "\r";    }    var txtObj = activeDocument.textFrames.add();    txtObj.top = -10;    txtObj.left = 20;    txtObj.contents = txt;})();// -----------------------------------------------------------------------// 日本語ファイル名を変換する関数 (MacOS Xのみ。Windowsは不要)// -----------------------------------------------------------------------function convertKana(filename){    var dakuten = "%E3%82%99";    var handakuten = "%E3%82%9A";    filename = convertKanaSub(filename,dakuten,1);    filename = convertKanaSub(filename,handakuten,2);    return File.decode(filename);    // 日本語ファイル名変換サブ処理    function convertKanaSub(srcName, code, count){        srcName = srcName.replace(/%E3%82%BF%E3%82%99/g, "%E3%83%80"); // ダだけ特殊処理        var text = srcName.split(code); // 濁点        for (var i=0; i<text.length-1; i++){            var str = text[i];            if (str == "") continue;            var body = str.substring(0,str.length-2);            var footL = str.substring(str.length-2, str.length);            var hexL = eval("0x"+footL) + count;            hexL = hexL.toString(16).toUpperCase();            text[i] = body+hexL;        }        return text.join("");    }}