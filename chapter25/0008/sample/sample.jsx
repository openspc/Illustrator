// フォルダ／サブフォルダ内にあるJPEGファイルを配置するvar fileExt = "*.jpg";  // 拡張子がjpgのファイルを取得するvar offsetX = 5;   // 開始位置の横方向のオフセットvar offsetY = 50;   // 開始位置の縦方向のオフセットvar imageW = 80;   // 画像の横幅var imageH = 80;   // 画像の縦幅var imageMarginW = 100; // // 横方向の画像との間隔var imageMarginH = 95; // 縦方向の画像との間隔var folderObj = Folder.selectDialog("フォルダを選択してください");var jpegFileList = [];  // 画像のファイルオブジェクトを入れる配列var count = 0;  // カウンタif (folderObj) {    // フォルダが選択された場合    jpegFileList = getFolder(folderObj, jpegFileList);    for(var y=0; y<8; y++){        for(var x =0; x< 6; x++){            var myImage = activeDocument.placedItems.add();            myImage.file = jpegFileList[count];            myImage.left = x * imageMarginW + offsetX;  // 画像のX座標を設定する            myImage.top = -y * imageMarginH - offsetY;  // 画像のY座標を設定する            myImage.width = imageH; // 画像の横幅を設定する            myImage.height = imageW;    // 画像の縦幅を設定する            count = count + 1;            myImage.embed();    // 埋め込み画像にする        }    }}// フォルダ内のファイル一覧を取得function getFolder(folderObj, jpegFileList){    jpegFileList = jpegFileList.concat(folderObj.getFiles(fileExt));    // JPEGファイルオブジェクトを連結    var fileList = folderObj.getFiles();    // フォルダ一覧を取得    for (var i=0; i<fileList.length; i++){        if (fileList[i].getFiles) { // フォルダがある場合は再帰処理を行う            jpegFileList = getFolder(fileList[i], jpegFileList);	// サブフォルダがある限り繰り返す        }    }    return jpegFileList;    // 結果を返す}