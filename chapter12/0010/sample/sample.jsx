// 選択した画像の数だけアートボードを追加するvar width = 595.28;    // アートボードの横幅(A4縦)var height = 841.89;    // アートボードの縦幅(A4縦)var top = 0;    // 上の座標値（単位はポイント）var left = 0;  // 左の座標値（単位はポイント）var bottom = -841.89;  // 下の座標値（単位はポイント）var right = left + width;    // 右の座標値（単位はポイント）var maxCountW = 4;  // 横の最大アートボード数var maxCountH = 3;  // 縦の最大アートボード数var countW = 0; // すでに最初に1つアートボードが存在するため2に設定var countH = 1;while(true){    var fileObj = File.openDialog("画像ファイルを選択してください");    if (!fileObj){ break; } // キャンセルされたら終了    var myImage = activeDocument.placedItems.add(); // 画像を配置    myImage.file = fileObj;    myImage.top = top;  // X座標値を設定    myImage.left = left;    // Y座標値を設定    var ratioW = width / myImage.width; // 横の比率を計算    var ratioH = height / myImage.height;   // 縦の比率を計算    if (ratioW < ratioH){   // 比率に応じて調整        ratio = ratioW;    }else{        ratio = ratioH;    }    // サイズ調整するかどうかの判断    if ((myImage.width < width) && (myImage.height < height)){ ratio = 1; }    myImage.width = myImage.width * ratio;    myImage.height = myImage.height * ratio;    left = left + width;    // 横一列に配置する    right = right + width;    // 横一列に配置する    countW = countW + 1;    if (countW >= maxCountW){ // 最大の横の枚数を超えた場合        countW = 0;        left = 0;   // アートボードのX座標を0に初期化する        right = left + width;    // アートボードの右側の座標を計算        top = top - height; // アートボードの上側の座標を計算        bottom = bottom - height;   // アートボードの下側の座標を計算        countH = countH + 1;        if (countH > maxCountH){    // 最大の縦幅を超えた場合            alert("設定されている最大アートボード数を超えました");            break;  // 終了        }    }    activeDocument.artboards.add([left, top, right, bottom]);   // アートボードを追加}